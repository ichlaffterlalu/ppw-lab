{% extends "lab_7/layout/base.html" %}
{% load staticfiles %}
{% block content %}
    <section name="friend-list" id="friend-list">
        <div class="container">
            <div class="row">
                <div class="col-md-8 col-lg-8">
                    <h2>Friend: Fasilkom</h2>
                    <div id="friend-list" class="list-group">

                    </div>
                </div>
            </div>
        </div>
    </section>
{% endblock %}
{% block scripts_page %}
    <script>
        $( document ).ready(function () {
            // lengkapi pemanggilan ajax berikut untuk mengambil daftar teman yang ada di database
            $.ajax({
                method: "GET",
                url: '{% url "lab-7:get-friend-list" %}', //URL untuk mendapatkan list teman
                data: {page: 1, per: 10},
                success: function (response) {
                    //tampilkan list teman ke halaman
                    //hint : gunakan fungsi jquery append()
                    friendList = JSON.parse(response);
                    if (friendList.length === 0) {
                        //tampilkan pesan error
                        html = '<div class="alert alert-danger text-center">' +
                                '<strong>Oops!</strong> Tidak ada teman</div>';
                        $("#friend-list").append(html);
                    }
                    else {
                        for (i=0; i<friendList.length; i++) {
                            curr = JSON.parse(friendList[i]);
                            name = curr.friend_name;
                            npm = curr.npm;
                            date = curr.added_at;

                            html = '<a class="list-group-item clearfix">' +
                                name + ' (' + npm + ') [added at: ' + date + ']</a>';
                            $("#friend-list").append(html);
                        }
                    }
                },
                error: function(error){
                    //tampilkan pesan error
                    html = '<div class="alert alert-danger text-center">' +
                        '<strong>Oops!</strong> Tidak ada teman</div>';
                    $("#friend-list").append(html);
                }
            });
        });
    </script>
{% endblock %}